"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},md5_1=__importDefault(require("md5")),Skript=function(){function e(){this.dom={app:this,pluckValue:function(e,r){var o=[];return document.querySelectorAll(e).forEach(function(e,t,n){"function"==typeof r&&!0!==r(e)||(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement?o.push(e.value):o.push(e.nodeValue))}),o},pluckAttribute:function(e,r,o){var a=[];return document.querySelectorAll(e).forEach(function(e,t,n){"function"==typeof o&&!0!==o(e)||a.push(e.getAttribute(r))}),a},count:function(e,t){if("string"!=typeof e&&!e.length)throw new Error("'"+e+"("+typeof e+")' - 유효한 셀렉터가 아닙니다.");var n="string"==typeof e?document.querySelectorAll(e):e,r=n.length;if("function"==typeof t)for(var r=0,o=0;o<n.length;o++)!0===t(n[o],o)&&r++;return r},getValue:function(e,t){void 0===t&&(t=null);e=document.querySelector(e);return e&&e.value||t}},this.number={comma:function(e){e=Number.parseFloat(""+e);return isNaN(e)?"":Number.isFinite(e)?e.toLocaleString():e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},this.str={contains:function(e,t){return-1<(e=""+e).indexOf(t=""+t)},containsAll:function(e,t){e=""+e;for(var n=0;n<t.length;n++){var r=""+t[n];if(r&&-1==e.indexOf(r))return!1}return!0},containsAny:function(e,t){e=""+e;for(var n=0;n<t.length;n++){var r=""+t[n];if(r&&-1<e.indexOf(r))return!0}return!1},endsWith:function(e,t){e=""+e;for(var n="string"==typeof t?[t]:t||[],r=0;r<n.length;r++){var o=""+(n[r]||"");if(o&&e.lastIndexOf(o)===e.length-o.length)return!0}return!1},finish:function(e,t){return this.endsWith(e=""+e,t=""+t)?e:e+t},startsWith:function(e,t){e=""+e;for(var n="string"==typeof t?[t]:t||[],r=0;r<n.length;r++){var o=""+(n[r]||"");if(o&&0===e.indexOf(o))return!0}return!1},start:function(e,t){return this.startsWith(e=""+e,t=""+t)?e:t+e},limit:function(e,t,n){return void 0===n&&(n="..."),(e=""+e).length>t?e.substring(0,t)+n:e},reverseLimit:function(e,t,n){return void 0===n&&(n="..."),(e=""+e).length>t?n+e.substring(e.length-t):e},wrap:function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),(e=""+e).split(t).join(n+t+r)},padLeft:function(e,t,n){return this.pad(e,t,n,"left")},padRight:function(e,t,n){return this.pad(e,t,n,"right")},pad:function(e,t,n,r){if(n=n||"",isNaN(t)||t<1)throw new Error("패딩 길이가 유효하지 않습니다.");if(""===n)throw new Error("패딩 문자가 지정되지 않았습니다.");if("left"!==r&&"right"!==r)throw new Error("패딩 방향이 유효하지 않습니다.");return(e=""+e).length<t?this.pad("right"===r?e+n:n+e,t,n,r):e},left:function(e,t){return(""+e).substring(0,t)},right:function(e,t){return(e=""+e).substring(e.length-t,t)}},this.md5=md5_1.default}return e.prototype.getQueryParam=function(e,t){var t=t||location.search,t=this.getQueryParams(t),e=e.split("[").map(function(e){return e.replace(/\]$/,"")}).filter(function(e){return""!==e}),n=t;return e.forEach(function(e){null!==n&&(n=null===n[e]||void 0===n[e]?null:n[e])}),void 0===n?null:n},e.prototype.getQueryParams=function(e){var c=this,e=e||location.search,l={};return e.replace(/[^?]*\?/,"").split("&").filter(function(e){return""!==e}).map(function(e){var t=e.indexOf("="),n=[e.substring(0,t),e.substring(t+1)],e=decodeURIComponent(n[0]),r=n[1]||"",t=e.match(/\[([^\[\]]*)\]/);if(null!==t&&t.index){n=e.substring(0,t.index),t=e.substring(t.index);if("[]"===t)l[n]||(l[n]=[]),l[n]=l[n],l[n].push(c.formatQueryParamValue(r));else{l[n]||(l[n]={});for(var o=t.match(/\[([^\[\]]*)\]/g)||[],a=l[n],i=0;i<o.length;i++){var u=o[i].replace(/^\[/,"").replace(/\]$/,"");""!==u?(a[u]||(o.length>=i+1&&"[]"===o[i+1]?a[u]=[]:a[u]={}),i===o.length-1?a[u]=c.formatQueryParamValue(r):a=a[u]):(a&&Array.isArray(a)||(a=[]),""!==r&&a.push(c.formatQueryParamValue(r)))}}}else l[e]=c.formatQueryParamValue(r)}),l},e.prototype.formatQueryParamValue=function(e){return"true"===e||"false"!==e&&(e.match(/^0/)||e.match(/[^\d\.]/)||isNaN(Number.parseFloat(e))||e!=Number.parseFloat(e).toString()?decodeURIComponent(e):Number.parseFloat(e))},e.prototype.clone=function(e){if(null===e||"object"!=typeof e)return e;var t,n=e.constructor();for(t in e)e.hasOwnProperty(t)&&(n[t]=this.clone(e[t]));return n},e.prototype.addAction=function(e,t,n){var r="function"==typeof t?{callback:t}:t||{};if(e&&r.callback&&r.callback){r.eventType=r.eventType||"click";for(var o=this.getTargetsFromSelector(e,n),a=0;a<o.length;a++)for(var i=o[a],u=r.eventType.split(","),c=0;c<u.length;c++){var l=u[c].trim();"$enter"===l?i.addEventListener("keyup",function(e){e&&"Enter"===e.key&&r.callback.call(this,o)}):"$esc"===l?i.addEventListener("keyup",function(e){!e||"Esc"!==e.key&&"Escape"!==e.key||r.callback.call(this,o)}):i.addEventListener(l,function(){r.callback.call(this,o)})}}},e.prototype.runAction=function(e,t,n){if(!e||!t||"function"!=typeof t)throw new Error("대상 선택기준이 없거나 실행할 함수가 없습니다.");for(var r=this.getTargetsFromSelector(e,n),o=0;o<r.length;o++){var a=r[o];t.call(a,r,o)}},e.prototype.getTargetsFromSelector=function(e,t){e=e instanceof HTMLElement?[e]:e instanceof NodeList?e:"window"===e||e===window?[window]:"document"===e||e===document?[document]:"string"==typeof e?(t instanceof HTMLElement?t:document).querySelectorAll(e||"temp.not-exist-selector"):e;return e},e.prototype.querify=function(e){if("string"==typeof e)return"?"+e+"=";var t,n=[];for(t in e)e.hasOwnProperty(t)&&!function r(o,a,i){if(null!==i&&"object"==typeof i)if(Array.isArray(i))0===i.length?o.push(a+"[]="):i.forEach(function(e){if(null!==e&&"object"==typeof e)if(Array.isArray(e))r(o,a+"[]",e);else if(c(e))o.push(a+"="+encodeURIComponent(l(i)));else for(var t in e){var n;e.hasOwnProperty(t)&&(n=e[t],r(o,a+"[]["+t+"]",n))}else"function"!=typeof e&&(c(e)?o.push(a+"[]="+encodeURIComponent(l(e))):o.push(a+"[]="+encodeURIComponent(u(e))))});else if(c(i))o.push(a+"="+encodeURIComponent(l(i)));else for(var e in i){var t;i.hasOwnProperty(e)&&(t=i[e],r(o,a+"["+e+"]",t))}else"function"!=typeof i&&(c(i)?o.push(a+"="+encodeURIComponent(l(i))):o.push(a+"="+encodeURIComponent(u(i))))}(n,t,e[t]);return 0<n.length?"?"+n.join("&"):"";function u(e){return null==e?"":e}function c(e){return e&&(e.constructor===Date||"function"==typeof e.getDateInstance&&e.getDateInstance()&&e.getDateInstance().constructor===Date)}function l(e){if(null==e)return"";if(e.constructor!==Date)return"function"==typeof e.getDateInstance&&e.getDateInstance()&&(e.getDateInstance().constructor,Date),u(e);var t=e.getFullYear();if(isNaN(t))return"Invalid Date";var n=""+(e.getMonth()+1);n.length<2&&(n="0"+n);var r=""+e.getDate();r.length<2&&(r="0"+r);var o=""+e.getHours();o.length<2&&(o="0"+o);var a=""+e.getMinutes();a.length<2&&(a="0"+a);e=""+e.getSeconds();return t+"-"+n+"-"+r+" "+o+":"+a+":"+(e=e.length<2?"0"+e:e)}},e.prototype.syncQueryParamsToPage=function(u,e){var e=(e||location.search).replace(/^\?/,"").split("&"),c={};e.map(function(e){return e.split("=")}).forEach(function(e){var t=decodeURIComponent(e[0]),n=decodeURIComponent(decodeURI(e[1]).replace(/\+/g," "));if(c[t]?c[t]=c[t]+1:c[t]=1,u)for(var r in u)if(u.hasOwnProperty(r)&&"function"==typeof u[r]){var o=new RegExp(r.split("[*]").map(function(e){return e.replace(/\[/g,"\\[").replace(/\]/g,"\\]")}).join("\\[([^\\]]*)\\]")+"$");if(t.match(o))return u[r](t,n,c[t])}if(u&&u[t]&&"function"==typeof u[t])return u[t](t,n,c[t]);var e=document.querySelectorAll('[name="'+t+'"]'),a=null;if((a=1<e.length?e[c[t]-1]:e[0])instanceof HTMLInputElement)switch(a.getAttribute("type")){case"checkbox":case"radio":var i=document.querySelector('[name="'+t+'"][value="'+n+'"]');i instanceof HTMLInputElement&&(i.checked=!0);break;default:a.value=n}else(a instanceof HTMLSelectElement||a instanceof HTMLTextAreaElement)&&(a.value=n)})},e.prototype.extract=function(e,t){e=document.querySelector(e),t=t||{dataType:"json",appends:{}};if(null===e)throw new Error("대상 엘리먼트가 존재하지 않습니다.");if("string"!=typeof t.dataType)throw new Error("반환 데이터 타입이 유효하지 않습니다");if("json"===t.dataType.toLowerCase())return this.extractJson(e,t.appends);if("formdata"===t.dataType.toLowerCase())return this.extractFormData(e,t.appends);throw new Error("반환 데이터 타입이 유효하지 않습니다")},e.prototype.extractJson=function(e,t,n){for(var r=e.querySelectorAll("[name]"),o=t||{},a=0;a<r.length;a++){var i=r[a],u=-1!==(c=i.getAttribute("name")||"").indexOf("[]"),c=c.replace("[]","");if(i instanceof HTMLSelectElement&&(n||i.value&&""!=i.value))o[c]=i.value;else if(i instanceof HTMLInputElement)switch((i.getAttribute("type")||"").toLowerCase()){case"checkbox":i.checked&&(u?(o[c]=Array.isArray(o[c])?o[c]:[],o[c].push(i.value)):o[c]=i.value);break;case"radio":i.checked&&(o[c]=i.value);break;case"text":case"password":case"email":case"hidden":case"search":case"number":case"tel":case"date":case"datetime":case"datetime-local":(n||i.value&&""!=i.value)&&(u?(o[c]=Array.isArray(o[c])?o[c]:[],o[c].push(i.value)):o[c]=i.value)}else i instanceof HTMLTextAreaElement&&(n||i.value&&""!=i.value)&&(o[c]=i.value)}return o},e.prototype.extractFormData=function(e,t,n){var r,o=e.querySelectorAll("[name]"),a=t||{},i=new FormData;for(r in a)i.append(r,a[r]);for(var u=0,c={},l=0;l<o.length;l++){var s=o[l],f=s.getAttribute("name")||"",p=-1!==f.indexOf("[]");if(s instanceof HTMLSelectElement&&s.value&&""!=s.value)i.append(f,s.value);else if(s instanceof HTMLInputElement||"[object HTMLInputElement]"==Object.getPrototypeOf(s).toString()){var h=s;switch((s.getAttribute("type")||"").toLowerCase()){case"checkbox":h.checked&&(p||i.delete(f),i.append(f,h.value));break;case"radio":h.checked&&i.append(f,h.value);break;case"text":case"password":case"email":case"hidden":case"search":case"tel":case"date":case"datetime":case"datetime-local":h.value&&""!=h.value&&i.append(f,h.value);break;case"file":if(h.files&&(u+=h.files.length),n)n(i,f,h.files,h);else if(h.files&&0<h.files.length)if(1<h.files.length)for(var d=0;d<h.files.length;d++){var m=h.files[d];i.append(f+"["+d+"]",m)}else i.append(f,h.files[0])}}else s instanceof HTMLTextAreaElement?s.value&&""!=s.value&&i.append(f,s.value):s instanceof HTMLElement&&s.hasAttribute("contenteditable")&&i.append(f,s.innerText)}if(0<u){var v,y={totalCount:u,files:{}};for(v in c){y.files[v]=[];for(l=0;l<c[v].length;l++){var g=c[v][l];y.files[v].push({isNew:g instanceof File,url:g instanceof File?null:(g.name||"").replace(/\?.*/,"")})}}i.append("metadata_files",JSON.stringify(y))}return i},e.prototype.wait=function(n){return new Promise(function(e){var t=window.setTimeout(function(){e(t)},1e3*n)})},e.prototype.range=function(e,t){if("number"!=typeof e)throw new Error("시작값이 없거나 숫자가 아닙니다.");if("number"!=typeof t)throw new Error("종료값이 없거나 숫자가 아닙니다.");if(t<e)throw new Error("시작값이 종료값보다 큽니다.");for(var n=[],r=e;r<=t;r++)n.push(r);return n},e.prototype.random=function(e,t,n){if(void 0===n&&(n=!0),"number"!=typeof e)throw new Error("최소값이 없거나 숫자가 아닙니다.");if("number"!=typeof t)throw new Error("최대값이 없거나 숫자가 아닙니다.");if(t<e)throw new Error("최소값이 최대값보다 큽니다.");t=t-e+1;return(!0===n?Math.floor(Math.random()*t):Math.random()*t)+e},e.prototype.groupBy=function(e,n,r){var o={};return Array.prototype.forEach.call(e,function(e){var t=e[n];-1<(""+n).indexOf(".")&&(t=e,n.split(".").forEach(function(e){t=t[e]||""})),"function"==typeof r&&(t=r(t)),o[t]?o[t].push(e):o[t]=[e]}),o},e.prototype.tick=function(n){return{intervalId:-1,count:1,tester:function(){return!0},endHandler:function(){},do:function(e){var t=this;return this.intervalId=window.setInterval(function(){!1===t.tester()?(clearInterval(t.intervalId),t.endHandler()):e(t.count++)},1e3*n),this},until:function(e){return"function"==typeof e&&(this.tester=e),this},whenEnd:function(e){return"function"==typeof e&&(this.endHandler=e),this}}},e.prototype.runWhenReady=function(e,o,a,t){void 0===a&&(a=0),void 0===t&&(t=1);var i="string"==typeof e||"function"==typeof e?[e]:e,u=0,c=setInterval(function(){0<a&&a<u&&clearInterval(c);for(var e=0;e<i.length;e++)if("function"==typeof i[e])try{if(!0!==i[e]())return void u++}catch(e){console.error(e),clearInterval(c)}else{if("string"!=typeof i[e])throw clearInterval(c),new Error("Unexpected Type ["+typeof i[e]+"] : 문자열 또는 boolean을 반환하는 함수여야합니다.");for(var t=i[e].split("."),n=window[t[0]],r=1;r<t.length;r++)if(null==(n=n[t[r]]))return void u++;if(null==n)return void u++}try{o()}catch(e){console.error(e)}finally{clearInterval(c)}},1e3*t)},e.prototype.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},e.prototype.countdown=function(e,t,n,r){var o,a=this;if(void 0===r&&(r=!1),"string"==typeof e){if(o=new Date(e),isNaN(o.getTime()))throw new Error("Date 타입으로 변환할 수 없습니다. ("+e+")")}else o=e;var i=o.getTime(),u=1;switch(t.toLowerCase()){case"s":case"second":case"seconds":break;case"ms":case"millisecond":case"milliseconds":u=.001;break;case"m":case"minute":case"minutes":u=60;break;case"h":case"hour":case"hours":u=3600}return!0===r&&(r=i-Date.now(),n(r,{hour:Math.floor(r/1e3/60/60),minute:Math.floor(r/1e3/60)%60,second:Math.floor(r/1e3)%60})),new Promise(function(e,t){try{a.tick(u).do(function(){var e=i-Date.now();n(e,{hour:Math.floor(e/1e3/60/60),minute:Math.floor(e/1e3/60)%60,second:Math.floor(e/1e3)%60})}).until(function(){return i>Date.now()}).whenEnd(function(){e()})}catch(e){t(e)}})},e}();module.exports=Skript;
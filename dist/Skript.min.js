"use strict";var __awaiter=this&&this.__awaiter||function(e,i,u,c){return new(u=u||Promise)(function(n,t){function r(e){try{a(c.next(e))}catch(e){t(e)}}function o(e){try{a(c.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}a((c=c.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(n,r){var o,a,i,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,a&&(i=2&t[0]?a.return:t[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,t[1])).done)return i;switch(a=0,(t=i?[2&t[0],i.value]:t)[0]){case 0:case 1:i=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(i=0<(i=u.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){u.label=t[1];break}if(6===t[0]&&u.label<i[1]){u.label=i[1],i=t;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(t);break}i[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],a=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},md5_1=__importDefault(require("md5")),Skript=function(){function e(){this.dom={app:this,pluckValue:function(e,r){var o=[];return document.querySelectorAll(e).forEach(function(e,t,n){"function"==typeof r&&!0!==r(e)||(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement?o.push(e.value):o.push(e.nodeValue))}),o},pluckAttribute:function(e,r,o){var a=[];return document.querySelectorAll(e).forEach(function(e,t,n){"function"==typeof o&&!0!==o(e)||a.push(e.getAttribute(r))}),a},count:function(e,t){if("string"!=typeof e&&!e.length)throw new Error("'"+e+"("+typeof e+")' - 유효한 셀렉터가 아닙니다.");var n="string"==typeof e?document.querySelectorAll(e):e,r=n.length;if("function"==typeof t)for(var r=0,o=0;o<n.length;o++)!0===t(n[o],o)&&r++;return r},getValue:function(e,t){void 0===t&&(t=null);e=document.querySelector(e);return e&&e.value||t}},this.number={comma:function(e){e=Number.parseFloat(""+e);return isNaN(e)?"":Number.isFinite(e)?e.toLocaleString():e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},this.str={contains:function(e,t){return-1<(e=""+e).indexOf(t=""+t)},containsAll:function(e,t){e=""+e;for(var n=0;n<t.length;n++){var r=""+t[n];if(r&&-1==e.indexOf(r))return!1}return!0},containsAny:function(e,t){e=""+e;for(var n=0;n<t.length;n++){var r=""+t[n];if(r&&-1<e.indexOf(r))return!0}return!1},endsWith:function(e,t){e=""+e;for(var n="string"==typeof t?[t]:t||[],r=0;r<n.length;r++){var o=""+(n[r]||"");if(o&&e.lastIndexOf(o)===e.length-o.length)return!0}return!1},finish:function(e,t){return this.endsWith(e=""+e,t=""+t)?e:e+t},startsWith:function(e,t){e=""+e;for(var n="string"==typeof t?[t]:t||[],r=0;r<n.length;r++){var o=""+(n[r]||"");if(o&&0===e.indexOf(o))return!0}return!1},start:function(e,t){return this.startsWith(e=""+e,t=""+t)?e:t+e},limit:function(e,t,n){return void 0===n&&(n="..."),(e=""+e).length>t?e.substring(0,t)+n:e},reverseLimit:function(e,t,n){return void 0===n&&(n="..."),(e=""+e).length>t?n+e.substring(e.length-t):e},wrap:function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),(e=""+e).split(t).join(n+t+r)},padLeft:function(e,t,n){return this.pad(e,t,n,"left")},padRight:function(e,t,n){return this.pad(e,t,n,"right")},pad:function(e,t,n,r){if(n=n||"",isNaN(t)||t<1)throw new Error("패딩 길이가 유효하지 않습니다.");if(""===n)throw new Error("패딩 문자가 지정되지 않았습니다.");if("left"!==r&&"right"!==r)throw new Error("패딩 방향이 유효하지 않습니다.");return(e=""+e).length<t?this.pad("right"===r?e+n:n+e,t,n,r):e},left:function(e,t){return(""+e).substring(0,t)},right:function(e,t){return(e=""+e).substring(e.length-t,t)}},this.md5=md5_1.default}return e.prototype.getQueryParam=function(e,t){var t=t||location.search,t=this.getQueryParams(t),e=e.split("[").map(function(e){return e.replace(/\]$/,"")}).filter(function(e){return""!==e}),n=t;return e.forEach(function(e){null!==n&&(n=null===n[e]||void 0===n[e]?null:n[e])}),void 0===n?null:n},e.prototype.getQueryParams=function(e){var c=this,e=e||location.search,l={};return e.replace(/[^?]*\?/,"").split("&").filter(function(e){return""!==e}).map(function(e){var t=e.indexOf("="),n=[e.substring(0,t),e.substring(t+1)],e=decodeURIComponent(n[0]),r=n[1]||"",t=e.match(/\[([^\[\]]*)\]/);if(null!==t&&t.index){n=e.substring(0,t.index),t=e.substring(t.index);if("[]"===t)l[n]||(l[n]=[]),l[n]=l[n],l[n].push(c.formatQueryParamValue(r));else{l[n]||(l[n]={});for(var o=t.match(/\[([^\[\]]*)\]/g)||[],a=l[n],i=0;i<o.length;i++){var u=o[i].replace(/^\[/,"").replace(/\]$/,"");""!==u?(a[u]||(o.length>=i+1&&"[]"===o[i+1]?a[u]=[]:a[u]={}),i===o.length-1?a[u]=c.formatQueryParamValue(r):a=a[u]):(a&&Array.isArray(a)||(a=[]),""!==r&&a.push(c.formatQueryParamValue(r)))}}}else l[e]=c.formatQueryParamValue(r)}),l},e.prototype.formatQueryParamValue=function(e){return"true"===e||"false"!==e&&(e.match(/^0/)||e.match(/[^\d\.]/)||isNaN(Number.parseFloat(e))||e!=Number.parseFloat(e).toString()?decodeURIComponent(e):Number.parseFloat(e))},e.prototype.clone=function(e){if(null===e||"object"!=typeof e)return e;var t,n=e.constructor();for(t in e)e.hasOwnProperty(t)&&(n[t]=this.clone(e[t]));return n},e.prototype.addAction=function(e,t,n){var r="function"==typeof t?{callback:t}:t||{};if(e&&r.callback&&r.callback){r.eventType=r.eventType||"click";for(var o=this.getTargetsFromSelector(e,n),a=0;a<o.length;a++)for(var i=o[a],u=r.eventType.split(","),c=0;c<u.length;c++){var l=u[c].trim();"$enter"===l?i.addEventListener("keyup",function(e){e&&"Enter"===e.key&&r.callback.call(this,o)}):"$esc"===l?i.addEventListener("keyup",function(e){!e||"Esc"!==e.key&&"Escape"!==e.key||r.callback.call(this,o)}):i.addEventListener(l,function(){r.callback.call(this,o)})}}},e.prototype.runAction=function(e,t,n){if(!e||!t||"function"!=typeof t)throw new Error("대상 선택기준이 없거나 실행할 함수가 없습니다.");for(var r=this.getTargetsFromSelector(e,n),o=0;o<r.length;o++){var a=r[o];t.call(a,r,o)}},e.prototype.getTargetsFromSelector=function(e,t){e=e instanceof HTMLElement?[e]:e instanceof NodeList?e:"window"===e||e===window?[window]:"document"===e||e===document?[document]:"string"==typeof e?(t instanceof HTMLElement?t:document).querySelectorAll(e||"temp.not-exist-selector"):e;return e},e.prototype.querify=function(e){if("string"==typeof e)return"?"+e+"=";var t,n=[];for(t in e)e.hasOwnProperty(t)&&!function r(o,a,i){if(null!==i&&"object"==typeof i)if(Array.isArray(i))0===i.length?o.push(a+"[]="):i.forEach(function(e){if(null!==e&&"object"==typeof e)if(Array.isArray(e))r(o,a+"[]",e);else if(c(e))o.push(a+"="+encodeURIComponent(l(i)));else for(var t in e){var n;e.hasOwnProperty(t)&&(n=e[t],r(o,a+"[]["+t+"]",n))}else"function"!=typeof e&&(c(e)?o.push(a+"[]="+encodeURIComponent(l(e))):o.push(a+"[]="+encodeURIComponent(u(e))))});else if(c(i))o.push(a+"="+encodeURIComponent(l(i)));else for(var e in i){var t;i.hasOwnProperty(e)&&(t=i[e],r(o,a+"["+e+"]",t))}else"function"!=typeof i&&(c(i)?o.push(a+"="+encodeURIComponent(l(i))):o.push(a+"="+encodeURIComponent(u(i))))}(n,t,e[t]);return 0<n.length?"?"+n.join("&"):"";function u(e){return null==e?"":e}function c(e){return e&&(e.constructor===Date||"function"==typeof e.getDateInstance&&e.getDateInstance()&&e.getDateInstance().constructor===Date)}function l(e){if(null==e)return"";if(e.constructor!==Date)return"function"==typeof e.getDateInstance&&e.getDateInstance()&&(e.getDateInstance().constructor,Date),u(e);var t=e.getFullYear();if(isNaN(t))return"Invalid Date";var n=""+(e.getMonth()+1);n.length<2&&(n="0"+n);var r=""+e.getDate();r.length<2&&(r="0"+r);var o=""+e.getHours();o.length<2&&(o="0"+o);var a=""+e.getMinutes();a.length<2&&(a="0"+a);e=""+e.getSeconds();return t+"-"+n+"-"+r+" "+o+":"+a+":"+(e=e.length<2?"0"+e:e)}},e.prototype.syncQueryParamsToPage=function(u,e){var e=(e||location.search).replace(/^\?/,"").split("&"),c={};e.map(function(e){return e.split("=")}).forEach(function(e){var t=decodeURIComponent(e[0]),n=decodeURIComponent(decodeURI(e[1]).replace(/\+/g," "));if(c[t]?c[t]=c[t]+1:c[t]=1,u)for(var r in u)if(u.hasOwnProperty(r)&&"function"==typeof u[r]){var o=new RegExp(r.split("[*]").map(function(e){return e.replace(/\[/g,"\\[").replace(/\]/g,"\\]")}).join("\\[([^\\]]*)\\]")+"$");if(t.match(o))return u[r](t,n,c[t])}if(u&&u[t]&&"function"==typeof u[t])return u[t](t,n,c[t]);var e=document.querySelectorAll('[name="'+t+'"]'),a=null;if((a=1<e.length?e[c[t]-1]:e[0])instanceof HTMLInputElement)switch(a.getAttribute("type")){case"checkbox":case"radio":var i=document.querySelector('[name="'+t+'"][value="'+n+'"]');i instanceof HTMLInputElement&&(i.checked=!0);break;default:a.value=n}else(a instanceof HTMLSelectElement||a instanceof HTMLTextAreaElement)&&(a.value=n)})},e.prototype.extract=function(e,t){e=document.querySelector(e),t=t||{dataType:"json",appends:{}};if(null===e)throw new Error("대상 엘리먼트가 존재하지 않습니다.");if("string"!=typeof t.dataType)throw new Error("반환 데이터 타입이 유효하지 않습니다");if("json"===t.dataType.toLowerCase())return this.extractJson(e,t.appends);if("formdata"===t.dataType.toLowerCase())return this.extractFormData(e,t.appends);throw new Error("반환 데이터 타입이 유효하지 않습니다")},e.prototype.extractJson=function(e,t,n){for(var r=e.querySelectorAll("[name]"),o=t||{},a=0;a<r.length;a++){var i=r[a],u=-1!==(c=i.getAttribute("name")||"").indexOf("[]"),c=c.replace("[]","");if(i instanceof HTMLSelectElement&&(n||i.value&&""!=i.value))o[c]=i.value;else if(i instanceof HTMLInputElement)switch((i.getAttribute("type")||"").toLowerCase()){case"checkbox":i.checked&&(u?(o[c]=Array.isArray(o[c])?o[c]:[],o[c].push(i.value)):o[c]=i.value);break;case"radio":i.checked&&(o[c]=i.value);break;case"text":case"password":case"email":case"hidden":case"search":case"number":case"tel":case"date":case"datetime":case"datetime-local":(n||i.value&&""!=i.value)&&(u?(o[c]=Array.isArray(o[c])?o[c]:[],o[c].push(i.value)):o[c]=i.value)}else i instanceof HTMLTextAreaElement&&(n||i.value&&""!=i.value)&&(o[c]=i.value)}return o},e.prototype.extractFormData=function(v,g,w){return __awaiter(this,void 0,void 0,function(){var t,n,r,o,a,i,u,c,l,s,f,p,h,d,y,m;return __generator(this,function(e){switch(e.label){case 0:for(o in t=v.querySelectorAll("[name]"),n=g||{},r=new FormData,n)r.append(o,n[o]);i={},y=a=0,e.label=1;case 1:return y<t.length?(u=t[y],c=u.getAttribute("name")||"",l=-1!==c.indexOf("[]"),u instanceof HTMLSelectElement&&u.value&&""!=u.value?(r.append(c,u.value),[3,12]):[3,2]):[3,13];case 2:if(!(u instanceof HTMLInputElement||"[object HTMLInputElement]"==Object.getPrototypeOf(u).toString()))return[3,11];switch(((s=u).getAttribute("type")||"").toLowerCase()){case"checkbox":return[3,3];case"radio":return[3,4];case"text":case"password":case"email":case"hidden":case"search":case"tel":case"date":case"datetime":case"datetime-local":return[3,5];case"file":return[3,6]}return[3,10];case 3:return s.checked&&(l||r.delete(c),r.append(c,s.value)),[3,10];case 4:return s.checked&&r.append(c,s.value),[3,10];case 5:return s.value&&""!=s.value&&r.append(c,s.value),[3,10];case 6:return s.files&&(a+=s.files.length),w?[4,w(r,c,s.files,s)]:[3,8];case 7:return e.sent(),[3,9];case 8:if(s.files&&0<s.files.length)if(1<s.files.length)for(f=0;f<s.files.length;f++)p=s.files[f],r.append(c+"["+f+"]",p);else r.append(c,s.files[0]);e.label=9;case 9:return[3,10];case 10:return[3,12];case 11:u instanceof HTMLTextAreaElement?u.value&&""!=u.value&&r.append(c,u.value):u instanceof HTMLElement&&u.hasAttribute("contenteditable")&&r.append(c,u.innerText),e.label=12;case 12:return y++,[3,1];case 13:if(0<a){for(d in h={totalCount:a,files:{}},i)for(h.files[d]=[],y=0;y<i[d].length;y++)m=i[d][y],h.files[d].push({isNew:m instanceof File,url:m instanceof File?null:(m.name||"").replace(/\?.*/,"")});r.append("metadata_files",JSON.stringify(h))}return[2,r]}})})},e.prototype.wait=function(n){return new Promise(function(e){var t=window.setTimeout(function(){e(t)},1e3*n)})},e.prototype.range=function(e,t){if("number"!=typeof e)throw new Error("시작값이 없거나 숫자가 아닙니다.");if("number"!=typeof t)throw new Error("종료값이 없거나 숫자가 아닙니다.");if(t<e)throw new Error("시작값이 종료값보다 큽니다.");for(var n=[],r=e;r<=t;r++)n.push(r);return n},e.prototype.random=function(e,t,n){if(void 0===n&&(n=!0),"number"!=typeof e)throw new Error("최소값이 없거나 숫자가 아닙니다.");if("number"!=typeof t)throw new Error("최대값이 없거나 숫자가 아닙니다.");if(t<e)throw new Error("최소값이 최대값보다 큽니다.");t=t-e+1;return(!0===n?Math.floor(Math.random()*t):Math.random()*t)+e},e.prototype.groupBy=function(e,n,r){var o={};return Array.prototype.forEach.call(e,function(e){var t=e[n];-1<(""+n).indexOf(".")&&(t=e,n.split(".").forEach(function(e){t=t[e]||""})),"function"==typeof r&&(t=r(t)),o[t]?o[t].push(e):o[t]=[e]}),o},e.prototype.tick=function(n){return{intervalId:-1,count:1,tester:function(){return!0},endHandler:function(){},do:function(e){var t=this;return this.intervalId=window.setInterval(function(){!1===t.tester()?(clearInterval(t.intervalId),t.endHandler()):e(t.count++)},1e3*n),this},until:function(e){return"function"==typeof e&&(this.tester=e),this},whenEnd:function(e){return"function"==typeof e&&(this.endHandler=e),this}}},e.prototype.runWhenReady=function(e,o,a,t){void 0===a&&(a=0),void 0===t&&(t=1);var i="string"==typeof e||"function"==typeof e?[e]:e,u=0,c=setInterval(function(){0<a&&a<u&&clearInterval(c);for(var e=0;e<i.length;e++)if("function"==typeof i[e])try{if(!0!==i[e]())return void u++}catch(e){console.error(e),clearInterval(c)}else{if("string"!=typeof i[e])throw clearInterval(c),new Error("Unexpected Type ["+typeof i[e]+"] : 문자열 또는 boolean을 반환하는 함수여야합니다.");for(var t=i[e].split("."),n=window[t[0]],r=1;r<t.length;r++)if(null==(n=n[t[r]]))return void u++;if(null==n)return void u++}try{o()}catch(e){console.error(e)}finally{clearInterval(c)}},1e3*t)},e.prototype.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},e.prototype.countdown=function(e,t,n,r){var o,a=this;if(void 0===r&&(r=!1),"string"==typeof e){if(o=new Date(e),isNaN(o.getTime()))throw new Error("Date 타입으로 변환할 수 없습니다. ("+e+")")}else o=e;var i=o.getTime(),u=1;switch(t.toLowerCase()){case"s":case"second":case"seconds":break;case"ms":case"millisecond":case"milliseconds":u=.001;break;case"m":case"minute":case"minutes":u=60;break;case"h":case"hour":case"hours":u=3600}return!0===r&&(r=i-Date.now(),n(r,{hour:Math.floor(r/1e3/60/60),minute:Math.floor(r/1e3/60)%60,second:Math.floor(r/1e3)%60})),new Promise(function(e,t){try{a.tick(u).do(function(){var e=i-Date.now();n(e,{hour:Math.floor(e/1e3/60/60),minute:Math.floor(e/1e3/60)%60,second:Math.floor(e/1e3)%60})}).until(function(){return i>Date.now()}).whenEnd(function(){e()})}catch(e){t(e)}})},e}();module.exports=Skript;